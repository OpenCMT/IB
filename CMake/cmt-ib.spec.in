Summary: Cosmic Muon Tomography analysis libraries
Name: cmt-ib
Version: @PKGVERSION@
Release: @PKGRELEASE@%{?dist}
License: EUROPEAN UNION PUBLIC LICENCE v. 1.2
Vendor: INFN
URL: https://github.com/OpenCMT/IB
Group: Development/Libraries
BuildArch: %{_arch}
BuildRequires: cmake3
BuildRequires: cmt-ulib-devel
BuildRoot: %{_tmppath}/%{name}-%{version}-%{release}-root-%(%{__id_u} -n)
AutoReqProv: yes
Source: %{name}-%{version}.tar.gz

%description
This package contains the analysis toolkit library for Cosmic Muon Tomography reconstruction,
analysis and imaging software Developed by University of Padova and INFN Sezione di Padova  Italy

%prep
%setup -c
rm -rf %{buildroot}
mkdir -p %{buildroot}

%build
mkdir %{_builddir}/%{name}-%{version}/build
cd %{_builddir}/%{name}-%{version}/build
cmake3 -DCMAKE_INSTALL_PREFIX=%{buildroot}/usr \
       -DULIB_USE_QT5=OFF \
       -DPACKAGE_INSTALL_LIB_DIR=%{buildroot}/usr/lib64 \
       %{_builddir}/%{name}-%{version}
make

%install
cd %{_builddir}/%{name}-%{version}/build
make install
#workaround
mv %{buildroot}/usr/lib/* %{buildroot}/usr/lib64
rm -rf %{buildroot}/usr/lib

%clean
rm -rf %{buildroot}

%files
%defattr(-,root,root)
/usr/lib64/libmutomIB.so.0.2

%package devel
Summary: Cosmic Muon Tomography analysis libraries, development files
Requires: %{name}
Requires: cmt-ulib-devel

%description devel
This package contains the analysis toolkit library for Cosmic Muon Tomography reconstruction,
analysis and imaging software Developed by University of Padova and INFN Sezione di Padova  Italy

%files devel
%defattr(-,root,root)
/usr/lib64/libmutomIB.so
/usr/lib64/cmake/mutom-0.2/*.cmake
%dir /usr/include/mutom-0.2/IB
/usr/include/mutom-0.2/IB/*.h
/usr/include/mutom-0.2/IB/*.hpp


%changelog
* Tue Dec 04 2018 Paolo Andreetto <paolo.andreetto@pd.infn.it> - 0.2.1-1
- Repackaging for CentOS 7

